##
## SPDX-FileCopyrightText: 2021 Splunk, Inc. <sales@splunk.com>
## SPDX-License-Identifier: LicenseRef-Splunk-8-2021
## DO NOT EDIT THIS FILE!
## Please make all changes to files in $SPLUNK_HOME/etc/apps/Splunk_TA_windows/local.
## To make changes, copy the section/stanza you want to change from $SPLUNK_HOME/etc/apps/Splunk_TA_windows/default
## into ../local and edit there.
##
###### Global Windows Eventtype ######

[DhcpSrvLog]
#tags = windows
search = sourcetype=DhcpSrvLog

[DhcpSrvLog_dhcp]
#tags = dhcp network session
search = sourcetype=DhcpSrvLog (msdhcp_id=13 OR msdhcp_id=14 OR msdhcp_id=15)

[DhcpSrvLog_end]
#tags = dhcp network session end
###### Security: Account Logon ######
## Authentication Ticket Granted/Failed
## EventCodes 4768, 4772, 672, 676
search = sourcetype=DhcpSrvLog (msdhcp_id=12 OR msdhcp_id=16 OR msdhcp_id=17 OR msdhcp_id=18)

[DhcpSrvLog_start]
#tags = dhcp network session start
search = sourcetype=DhcpSrvLog (msdhcp_id=10 OR msdhcp_id=11)

[ad-files]
search = sourcetype=MSAD:NT6:Replication OR sourcetype=MSAD:NT6:Health OR sourcetype=MSAD:NT6:SiteInfo OR sourcetype=MSAD:NT6:Netlogon OR sourcetype=ActiveDirectory OR sourcetype=MSAD:NT6:DNS-Health OR sourcetype=MSAD:NT6:DNS-Zone-Information OR sourcetype=MSAD:NT6:DNS

[admon]
search = sourcetype=ActiveDirectory

[admon-computer]
search = eventtype=admon objectCategory="*CN=Computer*"

[admon-gpo]
search = eventtype=admon objectCategory="*CN=Group-Policy-Container*"

[admon-group]
search = eventtype=admon objectCategory="*CN=Group*"

[admon-user]
search = eventtype=admon objectCategory="*CN=Person*"

[endpoint_services_processes]
## Endpoint Processes
search = source="WMI:WinEventLog:Security" OR sourcetype="WinEventLog" OR sourcetype="XmlWinEventLog"

[hostmon_disk]
#tags = inventory performance storage
search = sourcetype=WinHostMon (Type=Disk)

[hostmon_inventory]
#tags = os inventory cpu memory
search = sourcetype=WinHostMon (Type=OperatingSystem OR Type=Processor)

[hostmon_os]
#tags = os windows memory performance
search = sourcetype=WinHostMon Type=OperatingSystem

[hostmon_windows]
#tags = os windows
search = sourcetype=WinHostMon

[microsoft_windows_hostmon_process]
#tags = process report
search = sourcetype=WinHostMon source=process

[microsoft_windows_hostmon_service]
#tags = service report
search = sourcetype=WinHostMon source=service

[microsoft_windows_hostmon_service_time]
#tags = time synchronize os performance
### AD/DNS eventtypes###
search = sourcetype=WinHostMon source=service Name=W32Time

[msad-dc-health]
search = eventtype=powershell sourcetype="MSAD:*:Health"

[msad-dns-debuglog]
search = eventtype=ad-files sourcetype="MSAD:*:DNS"

[msad-dns-health]
search = eventtype=powershell sourcetype="MSAD:*:DNS-Health"

[msad-dns-zoneinfo]
search = eventtype=powershell sourcetype="MSAD:*:DNS-Zone-Information"

[msad-rep-health]
search = eventtype=powershell sourcetype="MSAD:*:Replication"

[msad-site]
search = eventtype=powershell sourcetype="MSAD:*:SiteInfo"

[msad-siteinfo]
search = eventtype=powershell sourcetype="MSAD:*:SiteInfo" Type="Site"

[msad-sitelinkinfo]
search = eventtype=powershell sourcetype="MSAD:*:SiteInfo" Type="SiteLink"

[msad-subnet-affinity]
search = sourcetype="MSAD:*:Netlogon" msad_affinity=NO_CLIENT_SITE

[msad-subnetinfo]
search = eventtype=powershell sourcetype="MSAD:*:SiteInfo" Type="Subnet"

[msdhcp]
#tags = dhcp network session windows
search = sourcetype=msdhcp

[msdhcp_end]
#tags = end
search = sourcetype=msdhcp (msdhcp_id=12 OR msdhcp_id=16 OR msdhcp_id=17)

[msdhcp_start]
#tags = start
search = sourcetype=msdhcp (msdhcp_id=10 OR msdhcp_id=11 OR msdhcp_id=13)

[netmon_windows]
#tags = os windows
search = sourcetype=WinNetMon

[nt6-dns-events]
search = sourcetype=MSAD:NT6:DNS

[perfmon]
search = sourcetype="Perfmon:*" OR sourcetype="PerfmonMk:*"

[perfmon-dns]
search = eventtype=perfmon (sourcetype="Perfmon:DNS" OR sourcetype="PerfmonMk:DNS")

[perfmon-ntds]
search = eventtype=perfmon (sourcetype="Perfmon:NTDS" OR sourcetype="PerfmonMk:NTDS")

[perfmon_cputime]
#tags = performance cpu report
search = (sourcetype=Perfmon:CPU OR sourcetype=PerfmonMk:CPU OR sourcetype=Perfmon:CPUTime)

[perfmon_cputime_anomalous]
#tags = anomalous
search = (sourcetype=Perfmon:CPU OR sourcetype=PerfmonMk:CPU OR sourcetype=Perfmon:CPUTime) windows_cpu_load_percent>90

[perfmon_freediskspace]
#tags = performance storage disk report
search = sourcetype=Perfmon:FreeDiskSpace

[perfmon_freediskspace_anomalous]
#tags = anomalous
search = sourcetype=Perfmon:FreeDiskSpace windows_storage_free_percent<10

[perfmon_logicaldisk]
#tags = performance storage disk
##ProcessorInformation
search = sourcetype=Perfmon:LogicalDisk OR sourcetype=PerfmonMk:LogicalDisk

[perfmon_memory]
#tags = performance memory report
search = sourcetype=Perfmon:Memory OR sourcetype=PerfmonMk:Memory

[perfmon_memory_anomalous]
#tags = anomalous
search = (sourcetype=Perfmon:Memory OR sourcetype=PerfmonMk:Memory) windows_mem_free<104857600

[perfmon_network]
#tags = performance network
search = sourcetype=Perfmon:Network OR sourcetype=PerfmonMk:Network

[perfmon_network_bandwidth]
#tags = performance network
search = (sourcetype=Perfmon:LocalNetwork OR sourcetype=PerfmonMk:Network OR sourcetype=Perfmon:Network) (counter="Current Bandwidth" OR Current_Bandwidth=*)

[perfmon_network_throughput]
#tags = performance network
search = (sourcetype=Perfmon:LocalNetwork OR sourcetype=PerfmonMk:Network OR sourcetype=Perfmon:Network) (counter="Bytes Total/sec" OR Bytes_Total/sec = *)

[perfmon_process]
#tags = performance process report
## Uptime
search = sourcetype=Perfmon:Process OR sourcetype=PerfmonMk:Process

[perfmon_processorinformation]
#tags = performance cpu report process
search = (sourcetype=Perfmon:ProcessorInformation OR sourcetype=PerfmonMk:ProcessorInformation)

[perfmon_system]
#tags = performance cpu report
## Disk
search = sourcetype=Perfmon:System OR sourcetype=PerfmonMk:System

[perfmon_windows]
#tags = os windows
search = sourcetype=Perfmon:* OR sourcetype=PerfmonMk:* OR sourcetype=WMI:Perfmon*

[powershell]
search = source=Powershell

[printmon_windows]
#tags = os windows
search = sourcetype=WinPrintMon

[script_listeningports]
#tags = port listening report
## Local Processes
search = sourcetype=Script:ListeningPorts

[script_windows]
#tags = os windows
search = sourcetype=Script:* source=*.bat

[winapp]
search = eventtype=wineventlog_application

[windows_account_created]
#tags = add account change
## User Account Enabled
## EventCodes 4722, 626
search = eventtype=wineventlog_security (EventCode=4720 OR EventCode=4741 OR EventCode=624 OR EventCode=645)

[windows_account_deleted]
#tags = delete account change
## User/Computer Account Changed
## EventCodes 4738, 4742, 642, 646, 625
search = eventtype=wineventlog_security (EventCode=4726 OR EventCode=4743 OR EventCode=630 OR EventCode=647)

[windows_account_disabled]
#tags = disable account change
## User/Computer Account Deleted
## EventCodes 4726, 4743, 630, 647
search = eventtype=wineventlog_security (EventCode=4725 OR EventCode=629)

[windows_account_enabled]
#tags = enable account change
## Change Password Attempt
## EventCodes 4723, 627
search = eventtype=wineventlog_security (EventCode=4722 OR EventCode=626)

[windows_account_lockout]
#tags = lock lockout account change
## User Account Unlocked
## EventCodes 4767, 671
search = eventtype=wineventlog_security (EventCode=4740 OR EventCode=644)

[windows_account_management]
#tags = account change management
## User/Computer Account Created
## EventCodes 4720, 4741, 624, 645
search = eventtype=wineventlog_security (ta_windows_security_CategoryString="Account Management" OR TaskCategory="User Account Management")

[windows_account_mapped]
## tags intentionally left blank
#tags = authentication
## The name: %2 could not be mapped for logon by: %1
## EventCodes 4775, 679
search = eventtype=wineventlog_security (EventCode=4774 OR EventCode=678)

[windows_account_modified]
#tags = modify account change
## User Account Locked Out
## EventCodes 4740, 644
search = eventtype=wineventlog_security (EventCode=4738 OR EventCode=4742 OR EventCode=642 OR EventCode=646 OR EventCode=625)

[windows_account_notmapped]
#tags = authentication
## Account Used for Logon by
## The domain controller attempted/failed to validate the credentials for an account
## The logon to account: %2 by: %1 from workstation: %3 failed.
## EventCodes 4776, 4777, 680, 681
search = eventtype=wineventlog_security (EventCode=4775 OR EventCode=679)

[windows_account_password_change]
#tags = password modify account change
## User Account password set
## EventCodes 4724, 628
search = eventtype=wineventlog_security (EventCode=4723 OR EventCode=627)

[windows_account_password_set]
#tags = password modify account change
## User Account Disabled
## EventCodes 4725, 629
search = eventtype=wineventlog_security (EventCode=4724 OR EventCode=628)

[windows_account_unlocked]
#tags = modify account change
###### Security: Audit (Event Log) ######
## The event logging service has shut down
## EventCode 1100
search = eventtype=wineventlog_security (EventCode=4767 OR EventCode=671)

[windows_account_used4logon]
#tags = authentication
## Session reconnected to winstation
## EventCodes 4778, 682
search = eventtype=wineventlog_security (EventCode=4776 OR EventCode=4777 OR EventCode=680 OR EventCode=681)

[windows_audit_backup]
#tags = audit backup change
## Logon/Logoff audit logs
## EventCode 4625
search = eventtype=wineventlog_security EventCode=1105

[windows_audit_errors]
#tags = audit error
## The audit log was cleared
## EventCodes 1102, 517
search = eventtype=wineventlog_security (EventCode=1101 OR EventCode=1104 OR EventCode=1108)

[windows_audit_log_cleared]
#tags = audit change delete cleared watchlist
## Event log automatic backup
## EventCode 1105
search = eventtype=wineventlog_security (EventCode=1102 OR EventCode=517)

[windows_audit_log_logon]
#tags = audit change
###### Security: Logon/Logoff ######
## User Logoff/User initiated logoff
## EventCodes 4634, 4647, 538, 551
search = eventtype=wineventlog_security EventCode=4625 (ta_windows_status=0xC0000064 OR ta_windows_status=0xC000006A OR ta_windows_status=0xC000006F OR ta_windows_status=0xC0000070 OR ta_windows_status=0xC0000071 OR ta_windows_status=0xC0000072 OR ta_windows_status=0XC000018C OR ta_windows_status=0XC0000192 OR ta_windows_status=0xC0000193 OR ta_windows_status=0xC0000234 OR ta_windows_status=0XC00002EE OR ta_windows_status=0XC0000413)

[windows_audit_log_stopped]
#tags = stop stopped watchlist
## Audit events have been dropped by the transport.
## The security Log is now full
## The event logging service encountered an error
## EventCodes 1101, 1104, 1108
search = eventtype=wineventlog_security EventCode=1100

[windows_audit_policy_change]
#tags = policy configuration modify audit change
## System security access was granted to an account
## EventCodes 4717, 621
search = eventtype=wineventlog_security (EventCode=4715 OR EventCode=4719 OR EventCode=612)

[windows_audit_policy_changed]
#tags = policy configuration modify audit change
## The following policy was active when the Windows Firewall started
## EventCodes 848, 849, 850
search = eventtype=wineventlog_security (EventCode=4912 OR EventCode=807)

[windows_auth_package]
#tags = process execute start
## A trusted logon process has registered with the Local Security Authority
## EventCodes 4611, 515
search = eventtype=wineventlog_security (EventCode=4610 OR EventCode=514)

[windows_auth_ticket_granted]
#tags = authentication
## Service Ticket Granted/Failed
## EventCodes 4769, 4773, 673, 677
search = eventtype=wineventlog_security (EventCode=4768 OR EventCode=672 OR EventCode=676)

[windows_endpoint_processes]
#tags = process report
## Endpoint Services
search = (source="WinEventLog:Security" OR source="XmlWinEventLog:Security") (EventCode=4688 OR EventCode=4689 OR EventCode=4696 OR EventCode=4673 OR EventCode=4674)

[windows_endpoint_services]
#tags = service report
## Security-CIM Mappings
## Endpoint Registry
search = (source="WinEventLog:Security" OR source="XmlWinEventLog:Security" OR source="WinEventLog:System" OR source="XmlWinEventLog:System") (EventCode=1100 OR EventCode=4697 OR EventCode=5024 OR EventCode=5025 OR EventCode=5030 OR EventCode=5033 OR EventCode=5034 OR EventCode=5035 OR EventCode=5478 OR EventCode=7036 OR EventCode=7040 OR EventCode=7045)

[windows_event_signature]
#tags = track_event_signatures
search = sourcetype=mycustom OR sourcetype=WinEventLog OR sourcetype=XmlWinEventLog OR sourcetype=WMI:WinEventLog:System OR sourcetype=WMI:WinEventLog:Security OR sourcetype=WMI:WinEventLog:Application OR sourcetype=wineventlog OR sourcetype=xmlwineventlog

[windows_firewall_policy_active]
#tags = application firewall configuration report
## A change has been made to Windows Firewall
## EventCodes 4946, 4947, 4948, 851, 852
search = eventtype=wineventlog_security (EventCode=848 OR EventCode=849 OR EventCode=850)

[windows_firewall_policy_change]
#tags = application firewall configuration modify
## The Windows Firewall has detected an application listening for incoming traffic
## EventCodes 4957, 861
search = eventtype=wineventlog_security (EventCode=4946 OR EventCode=4947 OR EventCode=4948 OR EventCode=851 OR EventCode=852)

[windows_firewall_port_listening]
#tags = application firewall port listening report
###### Security: Privilege Use ######
## Special privileges assigned to new logon
## EventCodes 4672, 576
search = eventtype=wineventlog_security (EventCode=4957 OR EventCode=861)

[windows_handle_closed]
#tags = resource file access stop
###### Security: Policy Change ######
## Audit Policy Change/The audit policy (SACL) on an object was changed
## EventCodes 4715, 4719, 612
search = eventtype=wineventlog_security (EventCode=4658 OR EventCode=562)

[windows_logoff]
#tags = access stop logoff
## A logon was attempted using explicit credentials
## EventCodes 4648, 552
search = eventtype=wineventlog_security (EventCode=4634 OR EventCode=4647 OR EventCode=538 OR EventCode=551)

[windows_logon_explicit]
#tags = authentication privileged
## An account failed to log on
## EventCodes 4625, 529, 530, 531, 532, 533, 534, 535, 536, 537, 539
search = eventtype=wineventlog_security (EventCode=4648 OR EventCode=552)

[windows_logon_failure]
#tags = authentication
## An account was successfully logged on
## EventCodes 4624, 528, 540
search = eventtype=wineventlog_security ((EventCode=4625 AND ta_windows_action!=error) OR EventCode=529 OR EventCode=530 OR EventCode=531 OR EventCode=532 OR EventCode=533 OR EventCode=534 OR EventCode=535 OR EventCode=536 OR EventCode=537 OR EventCode=539)

[windows_logon_process]
#tags = process authorization add
## A notification package has been loaded by the Security Account Manager
## EventCodes 4614, 518
search = eventtype=wineventlog_security (EventCode=4611 OR EventCode=515)

[windows_logon_success]
#tags = authentication
###### Security: Object Access ######
## Object Open
## EventCodes 4656, 560
search = eventtype=wineventlog_security (EventCode=4624 OR EventCode=528 OR EventCode=540)

[windows_notification_package]
#tags = process execute start
###### Security:  Vulnerability ######
## System security domain policy was changed
## EventCode 4739
search = eventtype=wineventlog_security (EventCode=4614 OR EventCode=518)

[windows_object_open]
#tags = resource file access start
## Handle Closed
## EventCodes 4658, 562
search = eventtype=wineventlog_security (EventCode=4656 OR EventCode=560)

[windows_pre_auth_failed]
#tags = authentication
## Account Mapped for Logon by
## EventCodes 4774, 678
search = eventtype=wineventlog_security (EventCode=4771 OR EventCode=675)

[windows_privileged_object_operation]
#tags = resource execute start privileged
###### Security: Process Tracking ######
## A new process has been created
## EventCodes 4688, 592
search = eventtype=wineventlog_security (EventCode=4674 OR EventCode=578)

[windows_privileged_service_call]
#tags = process execute start privileged
## Privileged object operation
## EventCodes 4674, 578
search = eventtype=wineventlog_security (EventCode=4673 OR EventCode=577)

[windows_process_exit]
#tags = process execute stop
## A process was assigned a primary token
## EventCodes 4696, 600
search = eventtype=wineventlog_security (EventCode=4689 OR EventCode=593)

[windows_process_new]
#tags = process execute start
## A process has exited
## EventCodes 4689, 593
search = eventtype=wineventlog_security (EventCode=4688 OR EventCode=592)

[windows_process_token]
#tags = process execute start privileged
###### Security: System ######
## An authentication package has been loaded by the Local Security Authority
## EventCodes 4610, 514
search = eventtype=wineventlog_security (EventCode=4696 OR EventCode=600)

[windows_security_access_granted]
#tags = access authorization add change account
## System security access was removed from an account
## EventCodes 4718, 622
search = eventtype=wineventlog_security (EventCode=4717 OR EventCode=621)

[windows_security_access_removed]
#tags = access authorization delete change account
## Per User Audit Policy was changed
## EventCodes 4912, 807
search = eventtype=wineventlog_security (EventCode=4718 OR EventCode=622)

[windows_security_authentication]
#tags = authentication
## Change Account - ADDON-42191
search = (source=WinEventLog:Security OR source=XmlWinEventLog:Security) (EventCode=4624 OR EventCode=4625)

[windows_security_change]
#tags = change
## Authentication
search = (source=WinEventLog:Security OR source=XmlWinEventLog:Security) (EventCode=5461 OR EventCode=4698 OR EventCode=4700 OR EventCode=4701 OR EventCode=4702 OR EventCode=4799)

[windows_security_change_account]
#tags = change account
## System-CIM Mapping
# Change Audit - ADDON-48489
search = (source=WinEventLog:Security OR source=XmlWinEventLog:Security) AND EventCode IN (4634,4703,4704,4705,4720,4722,4723,4724,4725,4726,4732,4738,4740,4767,4781,4800,4801)

[windows_security_change_audit]
#tags = change audit
## Change
search = (source=WinEventLog:Security OR source=XmlWinEventLog:Security) (EventCode=1101 OR EventCode=1108 OR EventCode=4719 OR EventCode=1102)

[windows_security_endpoint_port]
#tags = listening port
## Change Audit
search = (source=WinEventLog:Security OR source=XmlWinEventLog:Security) (EventCode=5158)

[windows_security_endpoint_registry]
#tags = endpoint registry
## Endpoint Port
search = (source=WinEventLog:Security OR source=XmlWinEventLog:Security) (EventCode=4657 OR (EventCode=4670 AND (Object_Type="Registry" OR ObjectType="Registry")))

[windows_security_misconfiguration_password_minimum_length]
#tags = misconfiguration password policy vulnerability report audit change
###### System: Time ######
## EventCode 35, 37
search = eventtype=wineventlog_security EventCode="4739" (Min__Password_Length<7 OR Mixed_Domain_Mode<7)

[windows_service_ticket_granted]
#tags = authentication
## Ticket Granted Renewed
## EventCodes 4770, 674
search = eventtype=wineventlog_security (EventCode=4769 OR EventCode=4773 OR EventCode=673 OR EventCode=677)

[windows_session_disconnected]
#tags = access stop logoff
###### Security: Account Management ######
search = eventtype=wineventlog_security (EventCode=4779 OR EventCode=683)

[windows_session_reconnected]
## tags intentionally left blank
#tags =
## Session disconnected from winstation
## EventCodes 4779, 683
search = eventtype=wineventlog_security (EventCode=4778 OR EventCode=682)

[windows_special_privileges]
#tags = authentication privileged
## Privileged Service Called
## EventCodes 4673, 577
search = eventtype=wineventlog_security (EventCode=4672 OR EventCode=576)

[windows_system_change_audit]
#tags = change audit
search = (source=WinEventLog:System OR source=XmlWinEventLog:System) (EventCode=104)

[windows_system_update]
#tags = system update
## EventCodes 17, 18, 19
search = eventtype=wineventlog_system "Windows Update Agent"

[windows_system_update_status]
#tags = status
search = eventtype=wineventlog_system "Windows Update Agent" (EventCode=17 OR EventCode=18 OR EventCode=19)

[windows_ticket_renewed]
## tags intentionally left blank
#tags =
## Pre-authentication failed
## EventCodes 4771, 675
search = eventtype=wineventlog_security (EventCode=4770 OR EventCode=674)

[windows_time_failure]
#tags = report time synchronize failure performance
###### System: Update ######
search = (eventtype=wineventlog_system (SourceName=W32Time OR Microsoft-Windows-Time-Service) (EventCode=17 OR EventCode=29 OR EventCode=36 OR EventCode=38)) OR (sourcetype=Script:TimesyncStatus windows_action=failure)

[windows_time_sync]
#tags = report time synchronize success performance
## EventCodes 17, 29, 36, 38
search = (eventtype=wineventlog_system (SourceName=W32Time OR SourceName=Microsoft-Windows-Time-Service) (EventCode=35 OR EventCode=37)) OR (sourcetype=Script:TimesyncStatus windows_action=success)

[windows_updatelog]
#tags = system update
search = sourcetype=WindowsUpdateLog

[windows_updatelog_status]
#tags = status
## WMI:Update
search = sourcetype=WindowsUpdateLog "Content Install" NOT "Download Succeeded" NOT "Reboot Completed" NOT "Hide Update"

[windowsupdatelog_windows]
#tags = os windows
search = sourcetype=WindowsUpdateLog

[wineventlog-dfs]
search = source="WinEventLog:DFS Replication" OR source="XmlWinEventLog:DFS Replication"

[wineventlog-dns]
search = source="WinEventLog:DNS Server" OR source="XmlWinEventLog:DNS Server"

[wineventlog-ds]
search = source="WinEventLog:Directory Service" OR source="XmlWinEventLog:Directory Service"

[wineventlog-filereplication]
search = source="WinEventLog:File Replication Service" OR source="XmlWinEventLog:File Replication Service"

[wineventlog-keymanagement]
search = source="WinEventLog:Key Management Service" OR source="XmlWinEventLog:Key Management Service"

[wineventlog_application]
#tags = os windows
search = source=WinEventLog:Application OR source=WMI:WinEventLog:Application OR source=XmlWinEventLog:Application

[wineventlog_security]
#tags = os windows
search = source=WinEventLog:Security OR source=WMI:WinEventLog:Security OR source=XmlWinEventLog:Security

[wineventlog_system]
#tags = os windows
search = source=WinEventLog:System OR source=WMI:WinEventLog:System OR source=XmlWinEventLog:System

[wineventlog_windows]
#tags = os windows
search = eventtype=wineventlog_application OR eventtype=wineventlog_system OR eventtype=wineventlog_security OR eventtype=wineventlog-ds OR eventtype=wineventlog-dfs OR eventtype=wineventlog-keymanagement OR eventtype=wineventlog-filereplication OR eventtype=wineventlog-dns

[winregistry_windows]
#tags = os windows endpoint change registry
search = sourcetype=WinRegistry

[winsec]
#tags = security
search = eventtype=wineventlog_security

[winsystem]
###### DHCP ######
search = eventtype=wineventlog_system

[wmi_computersystem]
#tags = performance memory
## CPUTime
search = sourcetype=WMI:ComputerSystem

[wmi_cputime]
#tags = performance cpu report
search = sourcetype=WMI:CPUTime

[wmi_cputime_anomalous]
#tags = anomalous
## System
search = sourcetype=WMI:CPUTime windows_percent_processor_time>90

[wmi_freediskspace]
#tags = performance storage disk report
search = sourcetype=WMI:FreeDiskSpace

[wmi_freediskspace_anomalous]
#tags = anomalous
search = sourcetype=WMI:FreeDiskSpace windows_storage_free_percent<10

[wmi_installed_packages]
#tags = system update status
###### Splunk WMI ######
## ComputerSystem
search = sourcetype=WMI:InstalledUpdates

[wmi_localprocesses]
#tags = process report
search = sourcetype=WMI:LocalProcesses

[wmi_localprocesses_anomalous]
#tags = anomalous
## Memory
search = sourcetype=WMI:LocalProcesses (windows_cpu_load_percent>50) NOT windows_app=*Total

[wmi_logicaldisk]
#tags = performance storage disk
## Listening Ports
search = sourcetype=WMI:LogicalDisk

[wmi_memory]
#tags = performance memory report
search = sourcetype=WMI:Memory

[wmi_memory_anomalous]
#tags = anomalous
## Service
search = sourcetype=WMI:Memory windows_mem_free<104857600

[wmi_network_bandwidth]
#tags = performance network
## Process
search = sourcetype=WMI:LocalNetwork CurrentBandwidth=*

[wmi_network_throughput]
#tags = performance network
search = sourcetype=WMI:LocalNetwork BytesTotalPersec=*

[wmi_service]
#tags = service report
search = sourcetype=WMI:Service

[wmi_service_state_anomalous]
#tags = anomalous
## Network
search = sourcetype=WMI:Service windows_start_mode=Auto windows_state=* NOT windows_state=Running

[wmi_service_status_anomalous]
#tags = anomalous
search = sourcetype=WMI:Service Status=* NOT Status=OK

[wmi_uptime]
#tags = performance uptime report
search = sourcetype=WMI:Uptime

[wmi_uptime_anomalous]
#tags = anomalous
## User Accounts
search = sourcetype=WMI:Uptime windows_uptime>2592000

[wmi_useraccounts]
#tags = account report inventory user
## Version
search = sourcetype=WMI:UserAccounts

[wmi_version]
#tags = system version report inventory
search = sourcetype=WMI:Version

[wmi_windows]
#tags = os windows
search = sourcetype=WMI:*
